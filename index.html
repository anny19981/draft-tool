<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LAN-Party</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
  <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
  <style>
    body { background:#fafafa; }
    #draft {
      display:flex; justify-content:space-between; align-items:flex-start; gap:20px;
    }
    .team { width:25%; text-align:center; }
    .bans, .picks {
      display:flex; justify-content:center; flex-wrap:wrap; gap:6px; margin-bottom:10px;
    }
    .bans img, .picks img {
      width:50px; height:50px; border-radius:8px; border:2px solid #555;
    }
    .champion-grid {
      display:grid; grid-template-columns:repeat(auto-fill,50px);
      gap:6px; max-height:400px; overflow-y:auto; justify-content:center;
    }
    .champion-grid img {
      width:48px; height:48px; border-radius:6px; cursor:pointer;
      transition:transform .1s;
    }
    .champion-grid img:hover { transform:scale(1.15); }
    .phase-info { text-align:center; font-size:18px; font-weight:bold; margin-bottom:10px; }
    .role-icon { width:24px; vertical-align:middle; margin-left:4px; }
    .champion-icon { width:40px; vertical-align:middle; margin-right:6px; }
    td img { vertical-align:middle; }
    .item-suggestions img { width:32px; margin:2px; }

    /* Unterschiedliche Optik f√ºr Bans und Picks */
.bans img.ban-icon {
  border: 2px solid #d9534f; /* Rot */
  box-shadow: 0 0 8px rgba(217,83,79,0.5);
}

.picks img.pick-icon {
  border: 2px solid #5cb85c; /* Gr√ºn */
  box-shadow: 0 0 8px rgba(92,184,92,0.5);
}

.phase-info {
  font-size: 20px;
  font-weight: bold;
  color: #222;
  margin-bottom: 10px;
  background: #f0f0f0;
  padding: 8px 12px;
  border-radius: 8px;
  display: inline-block;
}

#phase {
  color: #007bff;
}

    /* Essensplan */
.day-plan-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

.day-plan-table th,
.day-plan-table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

.day-plan-table th {
  background-color: #3f51b5;
  color: white;
}

.day-plan-table td input {
  width: 90%;
  padding: 4px;
  border: 1px solid #aaa;
  border-radius: 4px;
  text-align: center;
}

  </style>
</head>
<body>
  <!-- 1Ô∏è‚É£ Firebase initialisieren -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyD0NuzvLybziqAnFbhhqGpFVpLyovk0HW0",
      authDomain: "webseite-lan-party.firebaseapp.com",
      databaseURL: "https://webseite-lan-party-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "webseite-lan-party",
      storageBucket: "webseite-lan-party.firebasestorage.app",
      messagingSenderId: "211545726174",
      appId: "1:211545726174:web:68f5ca3a2b6e1627a9b64f",
      measurementId: "G-5LGMTWYF0K"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getDatabase(app); // <- Hiermit greifst du auf die Realtime Database zu
  </script>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">LAN-Party</span>
    </div>
    <div class="mdl-layout__tab-bar mdl-js-ripple-effect">
      <a href="#tab1" class="mdl-layout__tab is-active">√úbersicht</a>
      <a href="#tab2" class="mdl-layout__tab">Games</a>
      <a href="#tab3" class="mdl-layout__tab">Essen</a>
      <a href="#tab4" class="mdl-layout__tab">Ausgaben</a>
      <a href="#tab5" class="mdl-layout__tab">Spielplan</a>
      <a href="#tab6" class="mdl-layout__tab">Draft</a>
    </div>
  </header>
 <main class="mdl-layout__content">

    <!-- TAB 1: √úbersicht -->
<section class="mdl-layout__tab-panel is-active" id="tab1">
  <style>
    /* üé® Styling nur f√ºr diesen Abschnitt */
    .overview-card {
      background: linear-gradient(135deg, #0a0a1a, #162447);
      color: #f4f4f4;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      padding: 30px;
      max-width: 600px;
      margin: 60px auto;
      text-align: center;
      font-family: 'Poppins', sans-serif;
      border: 2px solid rgba(255, 215, 0, 0.2);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .overview-card:hover {
      transform: scale(1.02);
      box-shadow: 0 6px 25px rgba(255, 215, 0, 0.3);
    }

    .overview-card h2 {
      font-size: 2rem;
      color: #ffd700;
      margin-bottom: 10px;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
    }

    .overview-card p.subtitle {
      font-size: 1.1rem;
      color: #ccc;
      margin-bottom: 25px;
    }

    #timer {
      font-size: 2.5rem;
      letter-spacing: 2px;
      color: #00d9ff;
      text-shadow: 0 0 15px rgba(0, 217, 255, 0.7);
      font-weight: bold;
    }
        #timer2 {
      font-size: 2.5rem;
      letter-spacing: 2px;
      color: #00d9ff;
      text-shadow: 0 0 15px rgba(0, 217, 255, 0.7);
      font-weight: bold;
    }


    @media (max-width: 600px) {
      .overview-card {
        padding: 20px;
      }
      #timer {
        font-size: 2rem;
      }
    }
  </style>

  <div class="page-content">
    <div class="overview-card">
      <h2>LAN-Party Countdown</h2>
      <p class="subtitle">N√§chster Termin: <strong>20. November 2025</strong></p>
      <p id="timer">L√§dt‚Ä¶</p>
    </div>
  </div>

<div class="overview-card">
  <h2>Sonntag Football</h2>
  <p class="subtitle">N√§chster Termin: <strong>23. November 2025</strong></p>
  <p id="timer2">L√§dt‚Ä¶</p>
</div>

  <script>
    // üïí Countdown-Script 1
    const targetDate = new Date("Nov 20, 2025 17:00:00").getTime();
    const timerEl = document.getElementById("timer");

    function updateCountdown() {
      const now = new Date().getTime();
      const diff = targetDate - now;

      if (diff <= 0) {
        timerEl.textContent = "üéâ Es ist LAN-Zeit!";
        return;
      }
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const secs = Math.floor((diff % (1000 * 60)) / 1000);

      timerEl.textContent = `${days}d ${hours}h ${mins}m ${secs}s`;
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);
    // üïí Zweiter Timer
const targetDate2 = new Date("Nov 23, 2025 19:00:00").getTime();
const timerEl2 = document.getElementById("timer2");

function updateCountdown2() {
  const now = new Date().getTime();
  const diff = targetDate2 - now;

  if (diff <= 0) {
    timerEl2.textContent = "üéâ Event 2 l√§uft!";
    return;
  }

  const days = Math.floor(diff / (1000 * 60 * 60 * 24));
  const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
  const secs = Math.floor((diff % (1000 * 60)) / 1000);

  timerEl2.textContent = `${days}d ${hours}h ${mins}m ${secs}s`;
}

updateCountdown2();
setInterval(updateCountdown2, 1000);

  </script>
</section>
<!-- TAB 2: Games -->
<section class="mdl-layout__tab-panel" id="tab2">
  <div class="page-content">

    <h2>üéÆ Games</h2>
    <p>Hier kannst du alle Spiele eintragen, die bei der LAN-Party gespielt werden sollen.</p>

    <!-- Eingabe & Button -->
    <div style="display:flex; gap:10px; margin-bottom:20px;">
      <input type="text" id="gameInput" placeholder="Neues Spiel hinzuf√ºgen..." style="flex:1; padding:10px; border-radius:6px; border:1px solid #ccc;">
      <button id="addGameBtn" class="mdl-button mdl-js-button mdl-button--colored">+ Hinzuf√ºgen</button>
    </div>

    <!-- Game Liste -->
    <ul id="gameList" class="mdl-list" style="max-width:500px; margin:auto; padding:0;"></ul>

    <script>
      const gameInput = document.getElementById('gameInput');
      const addGameBtn = document.getElementById('addGameBtn');
      const gameList = document.getElementById('gameList');

      // Spiele aus dem LocalStorage laden
      let games = JSON.parse(localStorage.getItem('games')) || ["League of Legends", "Valorant", "Minecraft"];

      // Funktion: Liste rendern
      function renderGames() {
        gameList.innerHTML = "";
        games.forEach((game, index) => {
          const li = document.createElement('li');
          li.className = "mdl-list__item mdl-shadow--2dp";
          li.style.marginBottom = "10px";
          li.style.borderRadius = "6px";
          li.style.display = "flex";
          li.style.justifyContent = "space-between";
          li.style.alignItems = "center";
          li.style.padding = "10px 16px";
          li.style.background = "#f9f9f9";

          const span = document.createElement('span');
          span.textContent = game;
          span.style.fontWeight = "500";

          const delBtn = document.createElement('button');
          delBtn.className = "mdl-button mdl-js-button mdl-button--accent";
          delBtn.innerHTML = '<i class="material-icons">delete</i>';
          delBtn.onclick = () => removeGame(index);

          li.appendChild(span);
          li.appendChild(delBtn);
          gameList.appendChild(li);
        });
      }

      // Funktion: Neues Spiel hinzuf√ºgen
      function addGame() {
        const newGame = gameInput.value.trim();
        if (!newGame) {
          alert("Bitte gib einen Spielnamen ein!");
          return;
        }
        games.push(newGame);
        gameInput.value = "";
        saveGames();
        renderGames();
      }

      // Funktion: Spiel l√∂schen
      function removeGame(index) {
        games.splice(index, 1);
        saveGames();
        renderGames();
      }

      // Funktion: Speichern
      function saveGames() {
        localStorage.setItem('games', JSON.stringify(games));
      }

      // Event Listener
      addGameBtn.addEventListener('click', addGame);
      gameInput.addEventListener('keypress', e => {
        if (e.key === "Enter") addGame();
      });

      // Multi-Tab Sync
      window.addEventListener('storage', e => {
        if (e.key === 'games') {
          games = JSON.parse(e.newValue) || [];
          renderGames();
        }
      });

      // Erstes Rendern
      renderGames();
    </script>
  </div>
</section>

   <!-- TAB 3: Essen / Tagesplan -->
<section class="mdl-layout__tab-panel" id="tab3">
  <div class="page-content" style="padding:20px; max-width:700px; margin:auto;">
    <h3>Essens-Tagesplan</h3>
    <!-- Button um neuen Tag hinzuzuf√ºgen -->
    <div style="margin-bottom:20px; text-align:center;">
      <input id="newDayInput" placeholder="Neuer Tag..." style="padding:6px; width:150px;">
      <button id="addDayBtn" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored">Tag hinzuf√ºgen</button>
    </div>

    <!-- Plan wird hier gerendert -->
    <div id="dayPlanContainer"></div>
  </div>
</section>

    <!-- TAB 4: Ausgaben -->

<section class="mdl-layout__tab-panel" id="tab4">
  <div class="page-content" style="padding:20px; max-width:900px; margin:auto;">

    <h3>üí∞ Ausgaben & Kostenverteilung</h3>

    <!-- Personenverwaltung -->
    <h4>üë• Teilnehmer verwalten</h4>
    <div style="display:flex; gap:10px; margin-bottom:15px;">
      <input id="personInput" placeholder="Name hinzuf√ºgen..." style="padding:8px; flex:2;">
      <button id="addPersonBtn" class="mdl-button mdl-js-button mdl-button--colored">+ Person</button>
    </div>

    <ul id="personList" class="mdl-list" style="margin-bottom:25px;"></ul>

    <!-- Ausgabeneingabe -->
    <div style="display:flex; gap:10px; margin-bottom:20px;">
      <input id="expenseName" placeholder="Beschreibung" style="flex:2; padding:8px;">
      <input id="expenseAmount" type="number" placeholder="Betrag (‚Ç¨)" style="flex:1; padding:8px;">
      <select id="expenseBy" style="flex:1; padding:8px;"></select>
      <button id="addExpenseBtn" class="mdl-button mdl-js-button mdl-button--colored">
        + Ausgabe
      </button>
    </div>

    <!-- Ausgabenliste -->
    <table class="mdl-data-table mdl-shadow--2dp" style="width:100%;" id="expenseTable">
      <thead>
        <tr>
          <th>Beschreibung</th>
          <th>Betrag</th>
          <th>Bezahlt von</th>
          <th></th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h4 style="margin-top:30px;">üìä Abrechnung</h4>
    <div id="settlementBox"
         style="padding:10px; background:#f0f0f0; border-radius:8px;"></div>

  </div>
</section>

    <!-- TAB 5: Spielplan -->
    <section class="mdl-layout__tab-panel" id="tab5">
      <div class="page-content" style="padding:20px;">
        <h3>League of Legends Spielplan</h3>
        <button id="addRowBtn" class="mdl-button mdl-js-button mdl-button--fab mdl-button--colored">
          <i class="material-icons">add</i>
        </button>
        <table id="lolTable" class="mdl-data-table mdl-js-data-table mdl-shadow--2dp"
               style="width:100%; margin-top:20px;">
          <thead>
            <tr>
              <th>Spieler</th><th>Rolle</th><th>Champion</th>
              <th>Gegner</th><th>Items</th>
            </tr>
          </thead><tbody></tbody>
        </table>
      </div>
    </section>

    <!-- TAB 6: Draft -->
    <section class="mdl-layout__tab-panel" id="tab6">
      <div class="page-content" style="padding:20px;">
        <h3>Mini Draft Tool ‚Äì Pick &amp; Ban</h3>
        <div id="draft">
          <div id="team-blue" class="team"><h4>Team Blau</h4><div class="bans"></div><div class="picks"></div></div>
          <div id="center">
            <div class="phase-info">Phase: <span id="phase">BANS</span></div>
            <div class="champion-grid"></div>
          </div>
          <div id="team-red" class="team"><h4>Team Rot</h4><div class="bans"></div><div class="picks"></div></div>
        </div>
        <div style="text-align:center;margin-top:20px;">
          <button id="nextPhaseBtn" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">N√§chste Phase</button>
          <button id="resetDraftBtn" class="mdl-button mdl-js-button mdl-button--raised">Reset</button>
        </div>
      </div>
    </section>

  </main>
</div>
<!-- ========== JAVASCRIPT ========== -->
 <script>
// === Timer ===
const countDownDate = new Date("Nov 20, 2025 14:00:00").getTime();
setInterval(() => {
  const dist = countDownDate - Date.now();
  if (dist < 0) {
    document.getElementById("timer").textContent = "Party l√§uft!";
    return;
  }
  const d = Math.floor(dist / (1000 * 60 * 60 * 24));
  const h = Math.floor((dist % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  const m = Math.floor((dist % (1000 * 60 * 60)) / (1000 * 60));
  const s = Math.floor((dist % (1000 * 60)) / 1000);
  document.getElementById("timer").textContent = `${d}d ${h}h ${m}m ${s}s`;
}, 1000);

// === ESSENSPLAN ===
let dayPlan = JSON.parse(localStorage.getItem("dayPlan")) || [
  { day: "Donnerstag", morning: "", lunch: "", evening: "" },
  { day: "Freitag", morning: "", lunch: "", evening: "" },
  { day: "Samstag", morning: "", lunch: "", evening: "" },
  { day: "Sonntag", morning: "", lunch: "", evening: "" },
];

function saveDayPlan() {
  localStorage.setItem("dayPlan", JSON.stringify(dayPlan));
}

function renderDayPlan() {
  const container = document.getElementById("dayPlanContainer");
  container.innerHTML = "";

  dayPlan.forEach((d, index) => {
    const dayDiv = document.createElement("div");
    dayDiv.style.border = "1px solid #ccc";
    dayDiv.style.borderRadius = "8px";
    dayDiv.style.padding = "10px";
    dayDiv.style.marginBottom = "12px";
    dayDiv.style.background = "#f9f9f9";

    const titleDiv = document.createElement("div");
    titleDiv.style.display = "flex";
    titleDiv.style.justifyContent = "space-between";
    titleDiv.style.alignItems = "center";
    titleDiv.innerHTML = `<strong>${d.day}</strong>`;

    const delDayBtn = document.createElement("button");
    delDayBtn.className = "mdl-button mdl-js-button mdl-button--accent";
    delDayBtn.textContent = "üóëÔ∏è";
    delDayBtn.onclick = () => {
      dayPlan.splice(index, 1);
      saveDayPlan();
      renderDayPlan();
    };
    titleDiv.appendChild(delDayBtn);
    dayDiv.appendChild(titleDiv);

    ["morning", "lunch", "evening"].forEach(meal => {
      const mealDiv = document.createElement("div");
      mealDiv.style.display = "flex";
      mealDiv.style.alignItems = "center";
      mealDiv.style.marginTop = "6px";

      const label = document.createElement("span");
      label.textContent = meal === "morning" ? "Morgen: " : meal === "lunch" ? "Mittag: " : "Abend: ";
      label.style.width = "70px";

      const input = document.createElement("input");
      input.value = d[meal];
      input.style.flex = "1";
      input.style.padding = "4px";
      input.style.borderRadius = "4px";
      input.style.border = "1px solid #ccc";

      input.oninput = () => {
        dayPlan[index][meal] = input.value;
        saveDayPlan();
      };

      mealDiv.appendChild(label);
      mealDiv.appendChild(input);
      dayDiv.appendChild(mealDiv);
    });

    container.appendChild(dayDiv);
  });
}

// Neuer Tag hinzuf√ºgen
document.getElementById("addDayBtn").onclick = () => {
  const val = document.getElementById("newDayInput").value.trim();
  if (!val) return;
  dayPlan.push({ day: val, morning: "", lunch: "", evening: "" });
  document.getElementById("newDayInput").value = "";
  saveDayPlan();
  renderDayPlan();
};

// Multi-Tab Sync f√ºr DayPlan
window.addEventListener("storage", (e) => {
  if (e.key === "dayPlan") {
    dayPlan = JSON.parse(e.newValue);
    renderDayPlan();
  }
});

// === PERSONENLISTE & AUSGABEN ===
let personsList = JSON.parse(localStorage.getItem("persons")) || [];
let expenses = JSON.parse(localStorage.getItem("expenses")) || [];

function savePersons() {
  localStorage.setItem("persons", JSON.stringify(personsList));
}
function saveExpenses() {
  localStorage.setItem("expenses", JSON.stringify(expenses));
}

function renderPersons() {
  const ul = document.getElementById("personList");
  ul.innerHTML = "";
  personsList.forEach((p, index) => {
    const li = document.createElement("li");
    li.className = "mdl-list__item";
    li.style.display = "flex";
    li.style.justifyContent = "space-between";
    li.style.alignItems = "center";

    li.innerHTML = `
      <span>${p}</span>
      <button class="mdl-button mdl-js-button mdl-button--accent">üóëÔ∏è</button>
    `;

    li.querySelector("button").onclick = () => {
      personsList.splice(index, 1);
      savePersons();
      renderPersons();
      renderExpensePersonDropdown();
      renderSettlement();
    };

    ul.appendChild(li);
  });
}

document.getElementById("addPersonBtn").onclick = () => {
  const val = document.getElementById("personInput").value.trim();
  if (!val) return;
  if (personsList.includes(val)) { alert("Diese Person existiert bereits!"); return; }

  personsList.push(val);
  savePersons();
  renderPersons();
  renderExpensePersonDropdown();
  renderSettlement();
  document.getElementById("personInput").value = "";
};

function renderExpensePersonDropdown() {
  const select = document.getElementById("expenseBy");
  select.innerHTML = personsList.map(p => `<option value="${p}">${p}</option>`).join("");
}

function renderExpenses() {
  const tbody = document.querySelector("#expenseTable tbody");
  tbody.innerHTML = "";
  expenses.forEach((exp, index) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${exp.name}</td>
      <td>${exp.amount.toFixed(2)} ‚Ç¨</td>
      <td>${exp.by}</td>
      <td>
        <button class="mdl-button mdl-js-button mdl-button--accent">üóëÔ∏è</button>
      </td>
    `;
    tr.querySelector("button").onclick = () => {
      expenses.splice(index, 1);
      saveExpenses();
      renderExpenses();
      renderSettlement();
    };
    tbody.appendChild(tr);
  });
}

document.getElementById("addExpenseBtn").onclick = () => {
  const name = document.getElementById("expenseName").value.trim();
  const amount = parseFloat(document.getElementById("expenseAmount").value);
  const by = document.getElementById("expenseBy").value.trim();
  if (!name || !by || isNaN(amount) || amount <= 0) { alert("Bitte Felder korrekt ausf√ºllen!"); return; }

  expenses.push({ name, amount, by });
  saveExpenses();
  document.getElementById("expenseName").value = "";
  document.getElementById("expenseAmount").value = "";
  renderExpenses();
  renderSettlement();
};

// Settlement
function renderSettlement() {
  const box = document.getElementById("settlementBox");
  if (personsList.length === 0) { box.innerHTML = "<p>Bitte zuerst Personen hinzuf√ºgen.</p>"; return; }
  if (expenses.length === 0) { box.innerHTML = "<p>Noch keine Ausgaben vorhanden.</p>"; return; }

  const totals = {};
  personsList.forEach(p => totals[p] = 0);
  expenses.forEach(e => totals[e.by] += e.amount);

  const totalSpent = expenses.reduce((a, b) => a + b.amount, 0);
  const fairShare = totalSpent / personsList.length;

  const balance = {};
  personsList.forEach(p => balance[p] = +(totals[p] - fairShare).toFixed(2));

  let owes = personsList.filter(p => balance[p] < 0);
  let gets = personsList.filter(p => balance[p] > 0);
  owes.sort((a, b) => balance[a] - balance[b]);
  gets.sort((a, b) => balance[b] - balance[a]);

  const lines = [];
  let i = 0, j = 0;
  while (i < owes.length && j < gets.length) {
    const debtor = owes[i];
    const creditor = gets[j];
    const amount = Math.min(-balance[debtor], balance[creditor]);
    lines.push(`${debtor} ‚ûú ${creditor}: <strong>${amount.toFixed(2)} ‚Ç¨</strong>`);
    balance[debtor] += amount;
    balance[creditor] -= amount;
    if (balance[debtor] === 0) i++;
    if (balance[creditor] === 0) j++;
  }

  box.innerHTML = `
    <p><strong>Gesamtausgaben:</strong> ${totalSpent.toFixed(2)} ‚Ç¨</p>
    <p><strong>Fair pro Person:</strong> ${fairShare.toFixed(2)} ‚Ç¨</p>
    <hr>
    ${lines.map(l => `<p>${l}</p>`).join("")}
  `;
}

// Multi-Tab Sync f√ºr Personen & Ausgaben
window.addEventListener("storage", (e) => {
  if (e.key === "persons") { personsList = JSON.parse(e.newValue); renderPersons(); renderExpensePersonDropdown(); renderSettlement(); }
  if (e.key === "expenses") { expenses = JSON.parse(e.newValue); renderExpenses(); renderSettlement(); }
});

// === DRAFT / SPIELPLAN ===
let draftChampionData = {};
let picked = [], banned = [];
let currentStep = 0;
const PHASES = [
  { type: "ban", team: "blue" }, { type: "ban", team: "red" }, { type: "ban", team: "blue" }, { type: "ban", team: "red" },
  { type: "ban", team: "blue" }, { type: "ban", team: "red" }, { type: "ban", team: "blue" }, { type: "ban", team: "red" },
  { type: "ban", team: "blue" }, { type: "ban", team: "red" },
  { type: "pick", team: "blue" }, { type: "pick", team: "red" }, { type: "pick", team: "blue" }, { type: "pick", team: "red" },
  { type: "pick", team: "blue" }, { type: "pick", team: "red" }, { type: "pick", team: "blue" }, { type: "pick", team: "red" },
  { type: "pick", team: "blue" }, { type: "pick", team: "red" }
];

function saveDraft() {
  localStorage.setItem("draft", JSON.stringify({ picked, banned, currentStep }));
}
function loadDraft() {
  const saved = JSON.parse(localStorage.getItem("draft"));
  if (!saved) return;
  picked = saved.picked || [];
  banned = saved.banned || [];
  currentStep = saved.currentStep || 0;
  updatePhaseInfo();
  renderDraftUI();
}

function renderDraftUI() {
  const teams = ["blue", "red"];
  teams.forEach(t => {
    const box = document.getElementById(`team-${t}`);
    box.querySelector(".bans").innerHTML = "";
    box.querySelector(".picks").innerHTML = "";
  });
  picked.forEach((name, idx) => {
    const team = PHASES[idx+10].team;
    const img = document.createElement("img");
    img.src = `https://ddragon.leagueoflegends.com/cdn/15.21.1/img/champion/${name}.png`;
    img.classList.add("pick-icon");
    document.querySelector(`#team-${team} .picks`).append(img);
  });
  banned.forEach((name, idx) => {
    const team = PHASES[idx].team;
    const img = document.createElement("img");
    img.src = `https://ddragon.leagueoflegends.com/cdn/15.21.1/img/champion/${name}.png`;
    img.classList.add("ban-icon");
    document.querySelector(`#team-${team} .bans`).append(img);
  });
}

function selectChampion(name, src) {
  const step = PHASES[currentStep]; if (!step) return;
  const list = step.type === "ban" ? banned : picked;
  if ([...picked, ...banned].includes(name)) return;
  list.push(name);
  const teamBox = step.team === "blue" ? "team-blue" : "team-red";
  const img = document.createElement("img");
  img.src = src;
  img.classList.add(step.type === "ban" ? "ban-icon" : "pick-icon");
  img.title = `${step.type.toUpperCase()}: ${name}`;
  document.querySelector(`#${teamBox} .${step.type === "ban" ? "bans" : "picks"}`).append(img);
  currentStep++;
  saveDraft();
  updatePhaseInfo();
}

function updatePhaseInfo() {
  const step = PHASES[currentStep];
  const phaseEl = document.getElementById("phase");
  if (!step) { phaseEl.textContent = "üéâ Draft abgeschlossen!"; return; }
  const phaseName = step.type === "ban" ? "BAN" : "PICK";
  const teamName = step.team === "blue" ? "Blau" : "Rot";
  phaseEl.textContent = `${phaseName} ‚Äì ${teamName} ist dran (${currentStep + 1}/${PHASES.length})`;
}

// Reset Draft
document.getElementById("resetDraftBtn").onclick = () => {
  picked = []; banned = []; currentStep = 0;
  saveDraft();
  renderDraftUI();
  updatePhaseInfo();
};

// Multi-Tab Sync Draft
window.addEventListener("storage", (e) => {
  if (e.key === "draft") { loadDraft(); }
});

// === Init ===
window.addEventListener("DOMContentLoaded", async () => {
  renderDayPlan();
  renderPersons();
  renderExpensePersonDropdown();
  renderExpenses();
  renderSettlement();
  loadDraft();
});
</script>

</body>
</html>










